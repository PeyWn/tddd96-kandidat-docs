\chapter{Jämförelse mellan TypeScript och JavaScript av Henrik Lindström}

\section{Inledning}
Vid utveckling av webbapplikationer är språkvalen något begränsade. I grunden är det dynamiskt typade JavaScript ofta det enda alternativet eftersom det är det enda scriptspråket med ett brett stöd av webbläsare. Vill man ha statisk typning så finns det dock alternativ som uppnår samma webbläsarstöd genom att kompileras till JavaScript. Ett av dessa är TypeScript som är en typad utökning av JavaScript. Under projektet användes delvis TypeScript och delvis JavaScript vid utveckling av webbklienten respektive webbservern.

I denna rapport utreds hur de två olika språken och dess olika typsystem påverkade utvecklingsarbetet i projektet Schemaläggningsstöd för kirurgi där en webbapplikation utvecklades.
\section{Syfte}
Denna rapport undersöker positiva och negativa effekter med användning av TypeScript jämfört med JavaScript i projektet. Mer specifikt är det de två språkens olika typsystem som ligger i fokus. Syftet med detta är att komma fram till vilka effekter statisk typning hade på utvecklingsarbetet jämfört med dynamisk. Detta innefattar effekter på feldetektering, kodförståelse och utvecklingsfart. 

\section{Frågeställningar}
För att uppfylla syftet kommer följande frågeställningar att besvaras i rapporten:
\begin{enumerate}
\item Bidrar den statiska typningen i TypeScript till att fel hittas tidigare under utvecklingen?
\item Bidrar den statiska typningen i TypeScript till kod som är lättare att läsa och förstå?
\item Hur påverkas produktivitet vid utveckling av statisk typning jämfört med dynamisk?
\end{enumerate}
\section{Bakgrund}
I projektet utvecklades en webbapplikation bestående av två delar, en webbklient och en webbserver. Eftersom det bestämdes att klienten skulle skrivas med hjälp av plattformen Angular medförde det också att språket TypeScript valdes. Detta eftersom Angular själv är skrivet i TypeScript. På serversidan bestämdes det istället att utvecklingen skulle ske med vanlig JavaScript. Både TypeScript och JavaScript användes alltså i projektet och en stor del av gruppen använde och fick erfarenheter om båda. Alla medlemmar hade också svaga eller inga kunskaper om de båda språken innan projektet. Detta innebar att projektet lämpade sig rätt så bra för denna undersökning.

Jämförelse mellan strikt och dynamiskt typade språk är relevant eftersom det finns många språk på båda sidor som flitigt används inom mjukvaruutveckling. Detta tyder på att båda typsystemen är mycket relevanta och det är därför intressant att jämföra dem, i det här fallet inom webbutveckling.
\section{Teori}
I denna del beskrivs teori gällande de de två språken som jämförs i rapporten och deras olika typsystem.
\subsection{JavaScript}
JavaScript är ett dynamiskt och objektorienterat skriptpråk som främst används för att programmera interaktiva webbsidor och webbapplikationer. Språket kan även kan köras utanför webbläsare genom t.ex. miljön Node.js där det ofta används som skriptspråk för webbservrar.\cite{henrik_js1}

Språkets syntax delar många likheter med kända språk som Java och C++ men det finns också stora skillnader. En av dessa är att JavaScript är ett dynamiskt typat språk. Detta innebär att variabler i språket inte har någon speciell typ, istället är det värden som håller i typinformationen. Det medför att en variabel kan hålla värden av vilken typ som helst och byta mellan dem. \cite{henrik_js2}

En annan stor skillnad är hur objekt hanteras i JavaScript. Det finns inga klasser utan endast objekt. Medlemsvariabler och funktioner för objektet skapas istället underkörning, antingen vid skapandet av objektet eller vid senare tillfälle. \cite{henrik_js3}
JavaScript är även ett interpreterat språk \cite{henrik_js1} vilket innebär att det kompileras utan istället körs direkt som det är skrivet. Detta medför bland annat att ett program kan köras problemfritt trots att det innehåller fel i koden, så länge körningen inte kommer till den felaktiga delen.
\subsection{TypeScript}
TypeScript är ett skriptspråk utvecklat Microsoft som är en strikt syntatisk övermängd till JavaScript. Vad detta betyder är att allt som är giltig JavaScript-kod är även giltig i TypeScript, men att extra funktionalitet också finns tillgänglig. De största utökningar som gjorts är frivillig statisk typning och klasser.

För att ha ett lika brett stöd som JavaScript är TypeScript ett kompilerat språk som omvandlas till vanlig JavaScript. Att det är ett kompilerat språk tillsammans med statisk typning och klasser tillåter TypeScript att hitta typfel och andra mindre fel som felstavningar direkt vid kompilering.
\subsection{Dynamisk typning}
Ett dynamiskt typat språk är ett språk där typkontroll endast görs vid körning av programmet och alltså inte alls i förväg. Detta innebär att variabler och funktioner i källkoden inte har någon förutbestämd typ. Variabler har fortfarande en typ men denna bestämns först vid tilldelning under körning och kan ändras.

Det går alltså inte direkt att se vilken typ en variabel eller funktion har i källkoden, utan detta kräver djupare analysering av denna.
\subsection{Statisk typning}
Att ett språk är statiskt typat betyder att typer för variabler och funktioner finns direkt i källkoden av programmet. Typerna är alltså bestämda i förväg och kan inte ändras under programmets körning.

Effekten av detta är att det direkt från koden går att avgöra typer på allt och därmed också ifall det finns typfel. Dessa kan då rapporteras innan programmet ens körs.
\section{Metod}
För att besvara frågeställningarna samlades gruppmedlemmarnas erfarenheter med de två olika språken under projektet. Många av medlemmarna kom under utvecklingen i kontakt med både JavaScript och TypeScript och hade därför en bra grund för att jämföra dem. Information samlades dels genom egna erfarenheter under projektet och dels genom intervjuer med övriga gruppmedlemmar i slutet av utvecklingsarbetet. Utöver gruppens erfarenheter studerades även litteratur om feldetektering och vidareutveckling av kod för dynamisk och statisk typning. Detta användes som jämförelse för de erfarenheter som samlats i gruppen.

\subsection{Egna erfarenheter}
Under projektets gång har jag, som hade rollen utvecklingsledare, fått många erfarenheter inom både JavaScript och TypeScript. Detta då jag behövde spendera mycket tid på både klienten och servern för att uppfylla min roll. I undersökningen kommer mina erfarenheter att kombineras med de från övriga gruppmedlemmar.

\subsection{Intervjuer}
För att hämta in erfarenheter inom hur gruppens övriga medlemmar upplevt att feldetektering, kodförståelse och utvecklingsfart påverkats hölls intervjuer med alla som hade fått erfarenhet av TypeScript under projektet. Detta gjordes för alla utom en medlem som endast arbetat med servern och ej kommit i kontakt med TypeScript-koden i klienten alls. Det blev därmed fem intervjuer som genomfördes. Frågorna som ställdes presenteras i bilaga \ref{appendix:henrik}, tabell \ref{henrik_fragor}.

\subsection{Litteraturstudie}
För att kunna jämföra de resultat som fås från projektgruppens erfarenheter utfördes även en litteraturstudie där rapporter relevanta till frågeställningarna betraktades. Dessa hittades genom att söka i bibliotekets databas på Linköpings universitet. 

\section{Resultat}
I denna sektion beskrivs resultaten från mina egna erfarenhter, intervjuerna och litteraturstudien som tillsammans utgör hela undersökningen.
\subsection{Egna erfarenheter}
Jag hade innan det här projektet inte ens hör talas om TypeScript. JavaScript hade jag i alla fall kommit i kontakt med några gånger innan, men mina kunskaper om språket var mycket begränsade.

Under själva projektet fick jag mycket tid åt utveckling och använde den ungefär jämnt över båda språken.
\subsubsection{Hitta fel}
Jag tycker att klasserna och den statiska typningen i TypeScript till viss del hjälpte mig att hitta fel tidigare under projektet. Detta var inte något jag märkte eller tänkte på när jag använde TypeScript utan snarare under utvecklingen i JavaScript. Det inträffade ett flertal gånger att jag råkade göra små fel i JavaScript som inte ens resulterade i ett fel vid körning. Till exempel vid felstavning av en medlem vid användning av ett objekt. Dessa var fel som hade givit fel vid kompilering om TypeScript använts men som istället inte hittades förrän dess effekter märktes av.
\subsubsection{Kodförståelse}
När det kom till att läsa och förstå kod skriven av andra medlemmar tyckte jag inte att klasser och statisk typning gjorde någon större skillnad. Det var definitivt till hjälp, speciellt att veta typer på argument och returvärden till funktioner, men bra dokumentation av kod i JavaScript hade kunnat ersätta detta till stor del.

Däremot var klasser och typer till stor hjälp vid användning av externa bibliotek. I JavaScript spenderade jag mycket tid i dokumentation och sökning på internet för att förstå hur dess funktioner kunde användas. Både att veta vad för slags objekt funktionen accepterade som argument och vad den returnerade för något. I TypeScript var detta betydligt mer klart, speciellt tack vare smidiga funktioner i utveklingsmiljön för autokomplettering och navigation till klassdeklarationer.
\subsubsection{Produktivitet}
Angående hur produktiv jag var med de båda språken har jag något blandade erfarenheter. Fördelarna med JavaScript var helt enkelt att det var mindre kod att skriva. Att slippa skriva ut typer för variabler gjorde ingen större skillnad, däremot sparades tid från att slippa deklarera klasser, speciellt för många små objekt.

TypeScript hade också fördelar som hänger ihop med det jag beskrev om att hitta fel och kodförståelse ovan. Detta då snabbare feldetektion och förståelse av koden bidrog till sparad tid och ökad produktivitet. 
\subsection{Intervjuer}
Resultaten från de fem intervjuer som genomfördes presenteras i bilaga \ref{appendix:henrik}, sektion \ref{henrik_svar}. 
\subsection{Litteraturstudie}
I litteraturstudien som genomfördes betraktades ett konferensbidrag om kvantifiering av detekterbara fel i JavaScript och en journalartikel som studerade statisk typnings påverkan på underhåll av mjukvara.

I konferensbidraget "To Type or Not to Type:
Quantifying Detectable Bugs in JavaScript" \cite{henrik_totypeornot} undersöktes fel som funnits och behövts fixas i publika JavaScript-projekt och ifall tillagt typinformation med bland annat TypeScript hade upptäckt felet vid kompilering. 

Resultatet av undersökningen påstår att användandet av TypeScript hade förhindrat 15\% av alla fel i JavaScript-projekt.

Journalartikeln "An empirical study on the impact of static typing
on software maintainability" beskriver ett experiment som testar om statisk typning förbättrar förståelse av odokumenterad kod och fixning av syntax och semantiska fel.


\cite{henrik_maintainability}

\section{Diskussion}
I denna sektion diskuteras de resultat som fåtts från undersökningen och metoden som använts.
\subsection{Resultat}
\subsection{Metod}
Intervju istället för enkät varför?
\section{Slutsatser}

%TypeScript är ett språk utvecklat av Microsoft som i princip är en påbyggnad av JavaScript som lägger till bland annat statisk typning och klasser. TypeScript kompilerar också till JavaScript.

%I webbapplikationen som kommer att utvecklas i projektet kommer det finnas både en klientdel och en serverdel. Klientdelen kommer att bygga på ramverket Angular, som använder TypeScript, och serverdelen på Node.js där JavaScript används. Alltså kommer alla medlemmar att få testa på båda språken. Jag tycker därför att det skulle vara intressant att undersöka för och nackdelar med den strikta typningen och klasserna i TypeScript jämfört med JavaScript, där typningen är dynamisk och klasser saknas. Speciellt av intresse är hurvida strikt typning hjälper till att minska antalet fel som görs under projektet.

%För att hitta material om detta har jag främst tänkt söka på Liu:s biblioteks hemsida men även på internet. Jag ska också samla in projektmedlemmarnas erfarenheter med de två språken under utvecklingens gång.
